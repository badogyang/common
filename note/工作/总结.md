# 通用





# 模组



## 高通问题



## 展锐

### CP2 log如何抓取

```
抓取CP2 日志，请尝试如下方法：

开机后输入如下命令，
touch /data/unisoc_cp2log_config.txt
chmod 777 /data/unisoc_cp2log_config.txt
echo "wcn_cp2_log_limit_size=500M;\n" > /data/unisoc_cp2log_config.txt
echo "wcn_cp2_file_max_num=20;\n" >> /data/unisoc_cp2log_config.txt
echo "wcn_cp2_file_cover_old=true;\n" >> /data/unisoc_cp2log_config.txt
echo "wcn_cp2_log_path="/data/unisoc_dbg";\n" >> /data/unisoc_cp2log_config.txt
以上命令输入一次即可

以下命令请在每次开机后输入
rm /data/unisoc_dbg/*
mkdir /data/unisoc_dbg
chmod 777 /data/unisoc_dbg
touch unisoc_cp2log_0.txt
chmod 777 /data/unisoc_dbg/*
echo "at+armlog=1\r" > /proc/mdbg/at_cmd
echo "at+armlog=1\r" > /proc/mdbg/at_cmd
echo "at+armlog=1\r" > /proc/mdbg/at_cmd


cat /dev/slog_wcn0 >/data/cp2.log   #以上方法不行的话尝试一下执行这个命令，还是不行提CQ给展锐，要求展锐排查。目前来看，android抓取cp2 log容易一些，如果问题在android系统上也有，最好使用android，展锐内部一般都是使用android来进行分析
```



## realtek问题



# bluez相关

## 获取源码

git clone git://git.kernel.org/pub/scm/bluetooth/bluez.git 

git clone git://git.kernel.org/pub/scm/libs/ell/ell.git

## 编译

### 常见编译问题及处理

根据错误提示安装对应软件包

1.error: GLib >= 2.28 is required

sudo apt install libglib2.0-dev

2.error: D-Bus >= 1.6 is required

sudo apt install libdbus-1-dev

3.error: libudev >= 172 is required

sudo apt install libudev-dev

4.error: libical is required

sudo apt install libical-dev

5.error: readline header files are required

sudo apt install libreadline-dev

6.error: rst2man is required

sudo apt install python-docutils
sudo which rst2man

rst2man这里如果不是未安装的问题，也有可能是python版本，切换一下就行。

sudo apt-get install libdw-dev

7.这一步还有可能出现json-c版本过低的问题，解决方法

```shell
wget https://s3.amazonaws.com/json-c_releases/releases/json-c-0.13.1.tar.gz

tar xvf json-c-0.13.1.tar.gz
cd json-c-0.13.1/

./configure --prefix=/usr --disable-static

make
sudo make install
```



## 接口不通，响应超时

![157642c01f12de47fb7187c0b59a8e7](./img/157642c01f12de47fb7187c0b59a8e7.png)

一般是模组问题引起，换一块模组尝试一下



## 高通patch未合入，芯片型号不识别

![4fa5624cffa8c3dd888c6a504d8d8a4](./img/4fa5624cffa8c3dd888c6a504d8d8a4.png)



## Can't init device hci0: Invalid request code (56)

![dddb7f80fe9bc1429c5f233d8709b9b](./img/dddb7f80fe9bc1429c5f233d8709b9b.png)

ubuntu 内核版本问题，从5.15换到5.4后解决




## Can't init device hci0: Operation not permitted (1)

hciconfig hci0 up使用这个报错

需要加sudo 权限

![image-20231018104757873](./img/image-20231018104757873.png)




## Realtek Bluetooth ERROR: h5_download_patch: Retransmission exhausts

在EC20 852R陪测版本遇到，固件版本问题，更新固件后解决。

![image-20231106171517957](./img/image-20231106171517957.png)



# bluez bluetoothctl开启失败 Waiting to connect to bluetoothd...

noah@noah-OptiPlex-7090:~/project/bluez$ bluetoothctl
**Waiting to connect to bluetoothd...**

**解决方法**

 systemctl status bluetooth 查看蓝牙状态

![image-20230328115549917](./img/image-20230328115549917.png)

**尝试启动蓝牙**

 systemctl start bluetooth

![image-20230328115647253](./img/image-20230328115647253.png)

提示我们重新加载

systemctl daemon-reload

![image-20230328120003834](./img/image-20230328120003834.png)

重新加载后再次启动一下蓝牙后成功解决

![image-20230328115901121](./img/image-20230328115901121.png)

